<!-- Assistant Tournées - Application Web pour la gestion des tournées -->
<!doctype html>
<html lang="fr">
  <head>
    <!-- Métadonnées de base -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Assistant Tournées — outil d'aide à la gestion et à la recherche d'adresses pour vos tournées."
    />
    <link rel="icon" href="assets/snipers.png" type="image/png" sizes="32x32" />
    <link rel="apple-touch-icon" href="assets/snipers.png" />
    <link rel="manifest" href="manifest.json" />
    <title>Assistant Tournées</title>
    <!-- Métadonnées Open Graph pour le partage -->
    <meta property="og:title" content="Assistant Tournées" />
    <meta
      property="og:description"
      content="Assistant Tournées — outil d'aide à la gestion et à la recherche d'adresses pour vos tournées."
    />
    <meta property="og:type" content="website" />
    <!-- Feuilles de style -->
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="app-container">
      <header class="app-header">
        <div class="header-inner">
          <div class="logo">
            <img
              src="assets/snipers.png"
              class="logo-img"
              alt="Logo Assistant Tournées"
              loading="lazy"
            />
          </div>
          <h1 class="site-title">Assistant Tournées</h1>
          <button id="modeToggle" class="mode-toggle" aria-label="Paramètres">
            Paramètres
          </button>
        </div>
      </header>

      <main class="main-content">
        <section id="userPanel">
          <h2 class="section-title">Sélectionnez un bras de distribution</h2>
          <div id="brasBtnContainer" class="city-btn-container"></div>

          <h2 id="titleVille" class="section-title mt-20 hidden">
            Sélectionnez une ville (optionnel)
          </h2>

          <div id="liveSearchContainer" class="search-section">
            <div class="search-wrapper">
              <label for="liveSearchInput" class="sr-only"
                >Rechercher une adresse</label
              >
              <input
                type="text"
                id="liveSearchInput"
                placeholder="Rechercher une adresse…"
                class="live-search-input"
                autocomplete="off"
                aria-label="Rechercher une adresse"
              />
              <button
                id="clearSearchBtn"
                class="clear-search-btn"
                aria-label="Effacer la recherche"
              >
                ✖
              </button>
            </div>
            <div
              id="liveSearchResults"
              class="live-search-results"
              aria-live="polite"
              role="list"
            ></div>
          </div>

          <div id="cityBtnContainer" class="city-btn-container"></div>

          <div class="voice-zone">
            <div class="button-row">
              <button
                id="voiceBtn"
                class="voice-btn"
                aria-label="Activer la recherche vocale"
              >
                <i class="fas fa-microphone"></i>
              </button>
              <button
                id="cameraBtn"
                class="voice-btn hidden"
                aria-label="Activer la caméra"
              >
                <i class="fas fa-camera"></i>
              </button>
            </div>
            <div
              id="statusText"
              class="status-text"
              role="status"
              aria-live="polite"
            >
              Prêt.
            </div>
          </div>

          <div id="noFileWarning" class="warning-msg">
            Aucun fichier chargé. Allez dans Paramètres.
          </div>
        </section>

        <section id="adminPanel" class="hidden">
          <h2 class="section-title">Gestion des données</h2>
          <div class="toggle-row">
            <span class="toggle-text">Thème sombre</span>
            <label class="toggle-label">
              <input type="checkbox" id="themeToggle" checked />
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-row">
            <span class="toggle-text">Reconnaissance visuelle</span>
            <label class="toggle-label">
              <input type="checkbox" id="cameraToggle" />
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="admin-actions">
            <label for="excelFile" class="file-btn"
              ><i class="fas fa-file-excel"></i>Import Excel</label
            >
            <input
              type="file"
              id="excelFile"
              accept=".xlsx, .xls"
              style="display: none"
            />
            <button id="exportExcelBtn" class="file-btn">
              <i class="fas fa-file-export"></i>Export Excel
            </button>
            <button id="clearStorageBtn" class="danger-btn">
              <i class="fas fa-trash"></i>Supprimer le fichier
            </button>
          </div>
          <div id="fileNameDisplay" class="file-name-display"></div>
          
          
          <div class="addresses-cards-container" id="addressesCardsContainer">
            <h3 class="section-title">Liste des adresses importées</h3>
            <div class="admin-actions">
            <button id="addAddressBtn" class="file-btn">
              <i class="fas fa-plus"></i>Ajouter une adresse
            </button>
          </div>
            <div id="addressesCardsContent"></div>
          </div>
        </section>
      </main>

      <footer class="app-footer">&copy; Frederic Boussemart by @Lefido</footer>
    </div>

    <div
      id="voicePopupOverlay"
      class="voice-popup-overlay hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="voiceConfirmText"
    >
      <div class="voice-popup-window">
        <div id="voiceConfirmText" class="voice-confirm-msg"></div>
        <div class="voice-confirm-btns">
          <button id="confirmBtn" class="confirm-action-btn">Confirmer</button>
          <button id="retryBtn" class="retry-action-btn">Réessayer</button>
          <button id="cancelBtn" class="cancel-action-btn">Annuler</button>
        </div>
      </div>
    </div>

    <div
      id="popupOverlay"
      class="popup-overlay hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="popupTitle"
    >
      <div class="popup-window">
        <h3 id="popupTitle" class="popup-title">Résultats</h3>
        <div id="popupContent" class="popup-scroll"></div>
        <button
          id="popupClose"
          class="mode-toggle"
          aria-label="Fermer la fenêtre"
        >
          Fermer
        </button>
      </div>
    </div>

    <div
      id="cameraPopupOverlay"
      class="popup-overlay hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="cameraPopupTitle"
    >
      <div class="popup-window">
        <h3 id="cameraPopupTitle" class="popup-title">Capturer une adresse</h3>
        <div id="cameraContainer" class="camera-container">
          <video id="cameraFeed" playsinline autoplay></video>
          <div id="scanRegion" class="scan-region"></div>
          <canvas id="captureCanvas" class="hidden"></canvas>
          <div id="cameraStatus" class="status-text">
            Démarrage de la caméra...
          </div>
        </div>
        <div class="camera-buttons-row">
          <button id="captureBtn" class="confirm-action-btn">Capturer</button>
          <button
            id="cameraPopupClose"
            class="mode-toggle"
            aria-label="Fermer la fenêtre"
          >
            Fermer
          </button>
        </div>
      </div>
    </div>

    <!-- Modal pour ajouter/modifier une adresse -->
    <div
      id="addressPopupOverlay"
      class="popup-overlay hidden"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="addressPopupTitle"
    >
      <div class="popup-window">
        <h3 id="addressPopupTitle" class="popup-title">Ajouter une adresse</h3>
        <div class="address-form">
          <div class="form-group">
            <label for="addressBras">BRAS</label>
            <input type="text" id="addressBras" class="form-input" placeholder="Ex: BRAS1" />
          </div>
          <div class="form-group">
            <label for="addressVille">Ville</label>
            <input type="text" id="addressVille" class="form-input" placeholder="Ex: Paris" />
          </div>
          <div class="form-group">
            <label for="addressRue">Adresse</label>
            <input type="text" id="addressRue" class="form-input" placeholder="Ex: Rue de la Paix" />
          </div>
          <div class="form-group">
            <label for="addressNumero">Numéro</label>
            <input type="text" id="addressNumero" class="form-input" placeholder="Ex: 10" />
          </div>
          <div class="form-group">
            <label for="addressType">Type Recherche</label>
            <select id="addressType" class="form-input">
              <option value="1">Type 1</option>
              <option value="2">Type 2</option>
            </select>
          </div>
        </div>
        <div class="form-buttons">
          <button id="saveAddressBtn" class="confirm-action-btn">Enregistrer</button>
          <button
            id="addressPopupClose"
            class="cancel-action-btn"
            aria-label="Fermer la fenêtre"
          >
            Annuler
          </button>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="script.js"></script>
  </body>
</html>
